openapi: 3.0.3
info:
  title: üè≠ Industrial Inventory API
  version: 1.0.0
  description: |
    ## Sistema de Inventario Industrial Minero
    
    API robusta y escalable para la gesti√≥n de inventario de instrumentos industriales mineros construida con Clean Architecture, TypeScript y PostgreSQL.
    
    ### Caracter√≠sticas Principales
    - ‚úÖ Gesti√≥n completa de instrumentos industriales (CRUD)
    - üîê Autenticaci√≥n JWT con roles y permisos
    - üìä Logging estructurado con Winston
    - üß™ Validaci√≥n robusta con Zod
    - üìö Documentaci√≥n interactiva completa
    - üèóÔ∏è Arquitectura limpia y escalable
    
    ### Tecnolog√≠as
    - **Backend**: Node.js, TypeScript, Express
    - **Base de Datos**: PostgreSQL
    - **Autenticaci√≥n**: JWT (JSON Web Tokens)
    - **Validaci√≥n**: Zod
    - **Logging**: Winston
    - **Documentaci√≥n**: Swagger/OpenAPI
    
    ### Arquitectura
    Este proyecto sigue los principios de Clean Architecture con 4 capas bien definidas:
    - **Domain Layer**: Entidades y reglas de negocio
    - **Application Layer**: Casos de uso y DTOs
    - **Infrastructure Layer**: Implementaciones t√©cnicas
    - **Presentation Layer**: Controladores y HTTP
    
    ---
    
    **Desarrollado por**: Daisy Castillo Sepulveda
    **Repositorio**: [GitHub](https://github.com/DaisyCastilloS/industrial-inventory)
    
  contact:
    name: Daisy Castillo Sepulveda
    url: https://github.com/DaisyCastilloS
    email: daisy.castillo@example.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: https://github.com/DaisyCastilloS/industrial-inventory/blob/main/README.md

servers:
  - url: http://localhost:3000
    description: Servidor de desarrollo local
  - url: https://api.industrial-inventory.com
    description: Servidor de producci√≥n (ejemplo)

tags:
  - name: Health
    description: Endpoints de estado y monitoreo del sistema
  - name: Authentication
    description: Endpoints para autenticaci√≥n y autorizaci√≥n de usuarios
  - name: Products
    description: Gesti√≥n completa de instrumentos industriales mineros

paths:
  /:
    get:
      summary: üè† Estado del servidor
      description: |
        Endpoint de bienvenida que confirma que la API est√° funcionando correctamente.
        
        ### Informaci√≥n Incluida
        - Estado del servidor
        - Versi√≥n de la API
        - Entorno de ejecuci√≥n
        - Timestamp de respuesta
      tags:
        - Health
      responses:
        '200':
          description: ‚úÖ Servidor funcionando correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Mensaje de confirmaci√≥n del estado
                    example: "‚úÖ Industrial Inventory API running"
                  timestamp:
                    type: string
                    format: date-time
                    description: Timestamp de la respuesta
                    example: "2024-01-15T10:30:00.000Z"
                  version:
                    type: string
                    description: Versi√≥n actual de la API
                    example: "1.0.0"
                  environment:
                    type: string
                    description: Entorno de ejecuci√≥n
                    example: "development"
                  status:
                    type: string
                    description: Estado del servidor
                    example: "healthy"
              example:
                message: "‚úÖ Industrial Inventory API running"
                timestamp: "2024-01-15T10:30:00.000Z"
                version: "1.0.0"
                environment: "development"
                status: "healthy"

  /auth/login:
    post:
      summary: üîê Iniciar sesi√≥n
      description: |
        Autentica un usuario y devuelve un token JWT para acceder a los endpoints protegidos.
        
        ### Proceso de Autenticaci√≥n
        1. Validaci√≥n de credenciales
        2. Verificaci√≥n de usuario activo
        3. Generaci√≥n de token JWT
        4. Retorno de informaci√≥n del usuario
        
        ### Seguridad
        - Contrase√±as encriptadas con bcrypt
        - Tokens JWT con expiraci√≥n configurable
        - Validaci√≥n de formato de email
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  description: Email del usuario registrado
                  example: "admin@industrial.com"
                password:
                  type: string
                  format: password
                  description: Contrase√±a del usuario (m√≠nimo 6 caracteres)
                  minLength: 6
                  example: "password123"
            example:
              email: "admin@industrial.com"
              password: "password123"
      responses:
        '200':
          description: ‚úÖ Login exitoso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
              example:
                success: true
                message: "Login exitoso"
                data:
                  token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImVtYWlsIjoiYWRtaW5AaW5kdXN0cmlhbC5jb20iLCJyb2xlIjoiQURNSU4iLCJpYXQiOjE3MDUzNzQwMDAsImV4cCI6MTcwNTQ2MDQwMH0.example"
                  user:
                    id: 1
                    email: "admin@industrial.com"
                    role: "ADMIN"
                    name: "Administrador"
                    isActive: true
                timestamp: "2024-01-15T10:30:00.000Z"
        '400':
          description: ‚ùå Datos de entrada inv√°lidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Email y contrase√±a son requeridos"
                error: "VALIDATION_ERROR"
                timestamp: "2024-01-15T10:30:00.000Z"
        '401':
          description: ‚ùå Credenciales inv√°lidas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Credenciales inv√°lidas"
                error: "INVALID_CREDENTIALS"
                timestamp: "2024-01-15T10:30:00.000Z"
        '500':
          description: ‚ùå Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Error interno del servidor"
                error: "INTERNAL_ERROR"
                timestamp: "2024-01-15T10:30:00.000Z"

  /auth/register:
    post:
      summary: "üìù Registro de usuario"
      description: |
        Registra un nuevo usuario en el sistema.
        - El email debe ser √∫nico.
        - La contrase√±a debe tener al menos 6 caracteres, una may√∫scula, una min√∫scula y un n√∫mero.
        - El rol puede ser ADMIN, USER o VIEWER.
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password, name]
              properties:
                email:
                  type: string
                  format: email
                  example: "usuario@mineria.com"
                password:
                  type: string
                  format: password
                  example: "Password123"
                name:
                  type: string
                  example: "Juan P√©rez"
                role:
                  type: string
                  enum: [ADMIN, USER, VIEWER]
                  example: "USER"
      responses:
        '201':
          description: "‚úÖ Usuario registrado exitosamente"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Usuario registrado exitosamente"
                  data:
                    type: object
                    properties:
                      id: { type: integer, example: 1 }
                      email: { type: string, example: "usuario@mineria.com" }
                      name: { type: string, example: "Juan P√©rez" }
                      role: { type: string, example: "USER" }
                      isActive: { type: boolean, example: true }
                      createdAt: { type: string, format: date-time, example: "2024-01-15T10:30:00.000Z" }
                      updatedAt: { type: string, format: date-time, example: "2024-01-15T10:30:00.000Z" }
                  timestamp:
                    type: string
                    format: date-time
                    example: "2024-01-15T10:30:00.000Z"
        '400':
          description: "‚ùå Datos de entrada inv√°lidos"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: "‚ùå El email ya est√° registrado"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /products:
    get:
      summary: üìã Listar instrumentos industriales mineros
      description: |
        Obtiene una lista paginada de todos los instrumentos industriales mineros en el inventario.
        
        ### Caracter√≠sticas
        - **Paginaci√≥n autom√°tica**: Control de p√°ginas y l√≠mites
        - **Filtrado avanzado**: Por categor√≠a, ubicaci√≥n, estado
        - **Ordenamiento flexible**: Por nombre, precio, cantidad, fecha
        - **B√∫squeda inteligente**: En nombre y descripci√≥n
        - **Respuesta optimizada**: Para grandes vol√∫menes de datos
        
        ### Par√°metros de Consulta
        - `page`: N√∫mero de p√°gina (default: 1)
        - `limit`: Elementos por p√°gina (default: 20, max: 100)
        - `sort`: Campo de ordenamiento
        - `order`: Direcci√≥n del ordenamiento
        - `search`: T√©rmino de b√∫squeda
        
        ### Permisos Requeridos
        - **ADMIN**: Acceso completo con todos los filtros
        - **USER**: Acceso de lectura con filtros b√°sicos
        - **VIEWER**: Solo lectura sin filtros avanzados
      tags:
        - Products
      security:
        - BearerAuth: []
      parameters:
        - name: page
          in: query
          description: N√∫mero de p√°gina (comienza en 1)
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          example: 1
        - name: limit
          in: query
          description: N√∫mero de instrumentos por p√°gina (m√°ximo 100)
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          example: 20
        - name: sort
          in: query
          description: Campo para ordenar los resultados
          required: false
          schema:
            type: string
            enum: [name, price, quantity, created_at, categoryId]
            default: created_at
          example: "name"
        - name: order
          in: query
          description: Orden de clasificaci√≥n (ascendente o descendente)
          required: false
          schema:
            type: string
            enum: [asc, desc]
            default: desc
          example: "desc"
        - name: search
          in: query
          description: T√©rmino de b√∫squeda en nombre y descripci√≥n
          required: false
          schema:
            type: string
            minLength: 2
          example: "sensor"
        - name: categoryId
          in: query
          description: Filtrar por ID de categor√≠a
          required: false
          schema:
            type: integer
            minimum: 1
          example: 2
        - name: isActive
          in: query
          description: Filtrar por estado activo/inactivo
          required: false
          schema:
            type: boolean
          example: true
      responses:
        '200':
          description: ‚úÖ Lista de instrumentos obtenida exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductListResponse'
              example:
                success: true
                message: "Instrumentos obtenidos exitosamente"
                data:
                  products:
                    - id: 1
                      name: "Sensor de Presi√≥n Industrial"
                      description: "Sensor de presi√≥n diferencial para monitoreo de fluidos en miner√≠a subterr√°nea"
                      price: 1250.00
                      quantity: 15
                      categoryId: 2
                      location: "Bodega Central - Zona Norte"
                      criticalStock: 5
                      isActive: true
                      created_at: "2024-01-15T10:30:00.000Z"
                      updated_at: "2024-01-15T10:30:00.000Z"
                    - id: 2
                      name: "Transmisor de Temperatura RTD"
                      description: "Transmisor de temperatura con sensor RTD Pt100 para control de procesos mineros"
                      price: 890.00
                      quantity: 25
                      categoryId: 3
                      location: "Bodega Sur - Zona Mina"
                      criticalStock: 3
                      isActive: true
                      created_at: "2024-01-15T10:30:00.000Z"
                      updated_at: "2024-01-15T10:30:00.000Z"
                    - id: 3
                      name: "Analizador de Gases Port√°til"
                      description: "Equipo port√°til para an√°lisis de gases en t√∫neles de mina"
                      price: 3500.00
                      quantity: 5
                      categoryId: 1
                      location: "Bodega Oeste - Zona Central"
                      criticalStock: 10
                      isActive: true
                      created_at: "2024-01-15T10:30:00.000Z"
                      updated_at: "2024-01-15T10:30:00.000Z"
                  pagination:
                    page: 1
                    limit: 20
                    total: 3
                    totalPages: 1
                    hasNext: false
                    hasPrev: false
                timestamp: "2024-01-15T10:30:00.000Z"
        '401':
          description: ‚ùå No autorizado - Token requerido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Token de autenticaci√≥n requerido"
                error: "UNAUTHORIZED"
                timestamp: "2024-01-15T10:30:00.000Z"
        '403':
          description: ‚ùå Acceso denegado - Permisos insuficientes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "No tienes permisos para acceder a este recurso"
                error: "FORBIDDEN"
                timestamp: "2024-01-15T10:30:00.000Z"
        '500':
          description: ‚ùå Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Error interno del servidor"
                error: "INTERNAL_ERROR"
                timestamp: "2024-01-15T10:30:00.000Z"

    post:
      summary: ‚ûï Crear nuevo instrumento industrial
      description: |
        Crea un nuevo instrumento industrial minero en el inventario.
        
        ### Validaciones de Entrada
        - **Nombre**: Requerido, m√°ximo 100 caracteres
        - **Descripci√≥n**: Requerido, m√°ximo 500 caracteres
        - **Precio**: Requerido, mayor a 0, m√°ximo 999,999.99
        - **Cantidad**: Requerido, entero mayor o igual a 0, m√°ximo 999,999
        - **Categor√≠a**: Requerido, ID de categor√≠a v√°lido
        - **Ubicaci√≥n**: Requerido, m√°ximo 200 caracteres
        - **Stock Cr√≠tico**: Requerido, entero mayor o igual a 0, m√°ximo 999,999
        - **Activo**: Requerido, booleano (default: true)
        
        ### Proceso de Creaci√≥n
        1. Validaci√≥n de datos con Zod
        2. Verificaci√≥n de unicidad
        3. Creaci√≥n en base de datos
        4. Retorno del instrumento creado
        
        ### Permisos Requeridos
        - **ADMIN**: Crear cualquier instrumento
        - **USER**: Crear instrumentos (limitado por categor√≠a)
      tags:
        - Products
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProductRequest'
            example:
              name: "Sensor de Presi√≥n Industrial"
              description: "Sensor de presi√≥n diferencial para monitoreo de fluidos en miner√≠a subterr√°nea"
              price: 1250.00
              quantity: 15
              categoryId: 2
              location: "Bodega Central - Zona Norte"
              criticalStock: 5
              isActive: true
      responses:
        '201':
          description: ‚úÖ Instrumento creado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductResponse'
              example:
                success: true
                message: "Instrumento creado exitosamente"
                data:
                  id: 1
                  name: "Sensor de Presi√≥n Industrial"
                  description: "Sensor de presi√≥n diferencial para monitoreo de fluidos en miner√≠a subterr√°nea"
                  price: 1250.00
                  quantity: 15
                  categoryId: 2
                  location: "Bodega Central - Zona Norte"
                  criticalStock: 5
                  isActive: true
                  created_at: "2024-01-15T10:30:00.000Z"
                  updated_at: "2024-01-15T10:30:00.000Z"
                timestamp: "2024-01-15T10:30:00.000Z"
        '400':
          description: ‚ùå Datos de entrada inv√°lidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
              example:
                success: false
                message: "Datos de entrada inv√°lidos"
                error: "VALIDATION_ERROR"
                details:
                  - field: "name"
                    message: "El nombre es requerido"
                    value: ""
                  - field: "price"
                    message: "El precio debe ser mayor a 0"
                    value: -1
                  - field: "categoryId"
                    message: "El ID de categor√≠a debe ser un entero positivo"
                    value: 0
                timestamp: "2024-01-15T10:30:00.000Z"
        '401':
          description: ‚ùå No autorizado - Token requerido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Token de autenticaci√≥n requerido"
                error: "UNAUTHORIZED"
                timestamp: "2024-01-15T10:30:00.000Z"
        '403':
          description: ‚ùå Acceso denegado - Permisos insuficientes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "No tienes permisos para crear instrumentos"
                error: "FORBIDDEN"
                timestamp: "2024-01-15T10:30:00.000Z"
        '409':
          description: ‚ùå Conflicto - Instrumento ya existe
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Ya existe un instrumento con ese nombre"
                error: "CONFLICT"
                timestamp: "2024-01-15T10:30:00.000Z"
        '500':
          description: ‚ùå Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Error interno del servidor"
                error: "INTERNAL_ERROR"
                timestamp: "2024-01-15T10:30:00.000Z"

  /products/{id}:
    get:
      summary: üîç Obtener instrumento por ID
      description: |
        Obtiene los detalles completos de un instrumento industrial espec√≠fico por su ID.
        
        ### Informaci√≥n Incluida
        - **Datos b√°sicos**: Nombre, descripci√≥n, precio, cantidad
        - **Metadatos**: Categor√≠a, ubicaci√≥n, stock cr√≠tico, estado
        - **Timestamps**: Fecha de creaci√≥n y √∫ltima actualizaci√≥n
        - **Estado actual**: Informaci√≥n del inventario en tiempo real
        
        ### Validaciones
        - ID debe ser un entero positivo
        - Instrumento debe existir en la base de datos
        - Usuario debe tener permisos de lectura
        
        ### Permisos Requeridos
        - **ADMIN**: Acceso completo a cualquier instrumento
        - **USER**: Acceso de lectura a instrumentos de su categor√≠a
        - **VIEWER**: Solo lectura de instrumentos p√∫blicos
      tags:
        - Products
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID √∫nico del instrumento a consultar
          required: true
          schema:
            type: integer
            minimum: 1
          example: 1
      responses:
        '200':
          description: ‚úÖ Instrumento encontrado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductResponse'
              example:
                success: true
                message: "Instrumento encontrado exitosamente"
                data:
                  id: 1
                  name: "Sensor de Presi√≥n Industrial"
                  description: "Sensor de presi√≥n diferencial para monitoreo de fluidos en miner√≠a subterr√°nea"
                  price: 1250.00
                  quantity: 15
                  categoryId: 2
                  location: "Bodega Central - Zona Norte"
                  criticalStock: 5
                  isActive: true
                  created_at: "2024-01-15T10:30:00.000Z"
                  updated_at: "2024-01-15T10:30:00.000Z"
                timestamp: "2024-01-15T10:30:00.000Z"
        '400':
          description: ‚ùå ID inv√°lido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "ID de instrumento inv√°lido"
                error: "VALIDATION_ERROR"
                timestamp: "2024-01-15T10:30:00.000Z"
        '401':
          description: ‚ùå No autorizado - Token requerido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Token de autenticaci√≥n requerido"
                error: "UNAUTHORIZED"
                timestamp: "2024-01-15T10:30:00.000Z"
        '403':
          description: ‚ùå Acceso denegado - Permisos insuficientes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "No tienes permisos para acceder a este instrumento"
                error: "FORBIDDEN"
                timestamp: "2024-01-15T10:30:00.000Z"
        '404':
          description: ‚ùå Instrumento no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Instrumento con ID 1 no encontrado"
                error: "NOT_FOUND"
                timestamp: "2024-01-15T10:30:00.000Z"
        '500':
          description: ‚ùå Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Error interno del servidor"
                error: "INTERNAL_ERROR"
                timestamp: "2024-01-15T10:30:00.000Z"

    put:
      summary: ‚úèÔ∏è Actualizar instrumento industrial
      description: |
        Actualiza los datos de un instrumento industrial existente.
        
        ### Caracter√≠sticas
        - **Actualizaci√≥n parcial**: Solo se actualizan los campos enviados
        - **Validaci√≥n en tiempo real**: Cada campo se valida individualmente
        - **Historial de cambios**: Se registra autom√°ticamente la modificaci√≥n
        - **Verificaci√≥n de permisos**: Seg√∫n el rol del usuario
        
        ### Campos Actualizables
        - `name`: Nombre del instrumento
        - `description`: Descripci√≥n detallada
        - `price`: Precio unitario
        - `quantity`: Cantidad en inventario
        - `categoryId`: ID de categor√≠a
        - `location`: Ubicaci√≥n f√≠sica
        - `criticalStock`: Stock cr√≠tico
        - `isActive`: Estado activo/inactivo
        
        ### Permisos Requeridos
        - **ADMIN**: Actualizar cualquier instrumento
        - **USER**: Actualizar instrumentos de su categor√≠a (limitado)
      tags:
        - Products
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID √∫nico del instrumento a actualizar
          required: true
          schema:
            type: integer
            minimum: 1
          example: 2
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProductRequest'
            example:
              name: "Transmisor de Temperatura RTD Mejorado"
              description: "Transmisor de temperatura con sensor RTD Pt100 para control de procesos mineros - Versi√≥n mejorada"
              price: 950.00
              quantity: 30
              categoryId: 3
              location: "Bodega Sur - Zona Mina - Estante A"
              criticalStock: 5
              isActive: true
      responses:
        '200':
          description: ‚úÖ Instrumento actualizado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductResponse'
              example:
                success: true
                message: "Instrumento actualizado exitosamente"
                data:
                  id: 2
                  name: "Transmisor de Temperatura RTD Mejorado"
                  description: "Transmisor de temperatura con sensor RTD Pt100 para control de procesos mineros - Versi√≥n mejorada"
                  price: 950.00
                  quantity: 30
                  categoryId: 3
                  location: "Bodega Sur - Zona Mina - Estante A"
                  criticalStock: 5
                  isActive: true
                  created_at: "2024-01-15T10:30:00.000Z"
                  updated_at: "2024-01-15T11:45:00.000Z"
                timestamp: "2024-01-15T11:45:00.000Z"
        '400':
          description: ‚ùå Datos de entrada inv√°lidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
              example:
                success: false
                message: "Datos de entrada inv√°lidos"
                error: "VALIDATION_ERROR"
                details:
                  - field: "price"
                    message: "El precio debe ser mayor a 0"
                    value: -50
                  - field: "quantity"
                    message: "La cantidad debe ser un entero no negativo"
                    value: -5
                timestamp: "2024-01-15T11:45:00.000Z"
        '401':
          description: ‚ùå No autorizado - Token requerido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Token de autenticaci√≥n requerido"
                error: "UNAUTHORIZED"
                timestamp: "2024-01-15T11:45:00.000Z"
        '403':
          description: ‚ùå Acceso denegado - Permisos insuficientes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "No tienes permisos para actualizar este instrumento"
                error: "FORBIDDEN"
                timestamp: "2024-01-15T11:45:00.000Z"
        '404':
          description: ‚ùå Instrumento no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Instrumento con ID 2 no encontrado"
                error: "NOT_FOUND"
                timestamp: "2024-01-15T11:45:00.000Z"
        '500':
          description: ‚ùå Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Error interno del servidor"
                error: "INTERNAL_ERROR"
                timestamp: "2024-01-15T11:45:00.000Z"

    delete:
      summary: üóëÔ∏è Eliminar instrumento industrial
      description: |
        Elimina permanentemente un instrumento industrial del inventario.
        
        ‚ö†Ô∏è **ADVERTENCIA**: Esta acci√≥n es irreversible y eliminar√° permanentemente el instrumento del sistema.
        
        ### Proceso de Eliminaci√≥n
        1. Verificaci√≥n de existencia del instrumento
        2. Validaci√≥n de permisos del usuario
        3. Eliminaci√≥n l√≥gica/f√≠sica seg√∫n configuraci√≥n
        4. Registro de la acci√≥n en logs
        
        ### Consideraciones
        - Solo instrumentos inactivos pueden ser eliminados
        - Se verifica que no haya dependencias activas
        - Se mantiene un registro de auditor√≠a
        
        ### Permisos Requeridos
        - **ADMIN**: Eliminar cualquier instrumento
        - **USER**: No puede eliminar instrumentos
      tags:
        - Products
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID √∫nico del instrumento a eliminar
          required: true
          schema:
            type: integer
            minimum: 1
          example: 3
      responses:
        '200':
          description: ‚úÖ Instrumento eliminado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteResponse'
              example:
                success: true
                message: "Instrumento eliminado exitosamente"
                data:
                  id: 3
                  deleted_at: "2024-01-15T12:00:00.000Z"
                timestamp: "2024-01-15T12:00:00.000Z"
        '400':
          description: ‚ùå ID inv√°lido o instrumento no puede ser eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "El instrumento no puede ser eliminado porque est√° activo"
                error: "VALIDATION_ERROR"
                timestamp: "2024-01-15T12:00:00.000Z"
        '401':
          description: ‚ùå No autorizado - Token requerido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Token de autenticaci√≥n requerido"
                error: "UNAUTHORIZED"
                timestamp: "2024-01-15T12:00:00.000Z"
        '403':
          description: ‚ùå Acceso denegado - Permisos insuficientes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "No tienes permisos para eliminar instrumentos"
                error: "FORBIDDEN"
                timestamp: "2024-01-15T12:00:00.000Z"
        '404':
          description: ‚ùå Instrumento no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Instrumento con ID 3 no encontrado"
                error: "NOT_FOUND"
                timestamp: "2024-01-15T12:00:00.000Z"
        '500':
          description: ‚ùå Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                message: "Error interno del servidor"
                error: "INTERNAL_ERROR"
                timestamp: "2024-01-15T12:00:00.000Z"

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Token JWT obtenido al iniciar sesi√≥n.
        
        **Formato**: `Bearer <token>`
        
        **Ejemplo**: `Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`
        
        **Duraci√≥n**: 24 horas (configurable)

  schemas:
    # Esquemas de Autenticaci√≥n
    AuthResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Login exitoso"
        data:
          type: object
          properties:
            token:
              type: string
              description: Token JWT para autenticaci√≥n
              example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
            user:
              $ref: '#/components/schemas/User'
        timestamp:
          type: string
          format: date-time
          example: "2024-01-15T10:30:00.000Z"

    User:
      type: object
      properties:
        id:
          type: integer
          example: 1
        email:
          type: string
          format: email
          example: "admin@industrial.com"
        role:
          type: string
          enum: [ADMIN, USER, VIEWER]
          example: "ADMIN"
        name:
          type: string
          example: "Administrador"
        created_at:
          type: string
          format: date-time
          example: "2024-01-15T10:30:00.000Z"

    # Esquemas de Productos
    Product:
      type: object
      properties:
        id:
          type: integer
          description: ID √∫nico del instrumento
          example: 1
        name:
          type: string
          description: Nombre del instrumento industrial minero
          maxLength: 100
          example: "Sensor de Presi√≥n Industrial"
        description:
          type: string
          description: Descripci√≥n detallada del instrumento
          maxLength: 500
          example: "Sensor de presi√≥n diferencial para monitoreo de fluidos en miner√≠a subterr√°nea"
        price:
          type: number
          format: float
          description: Precio unitario del instrumento
          minimum: 0
          maximum: 999999.99
          example: 1250.00
        quantity:
          type: integer
          description: Cantidad disponible en inventario
          minimum: 0
          maximum: 999999
          example: 15
        categoryId:
          type: integer
          description: ID de la categor√≠a del instrumento
          minimum: 1
          example: 2
        location:
          type: string
          description: Ubicaci√≥n f√≠sica o almac√©n del instrumento
          maxLength: 200
          example: "Bodega Central - Zona Norte"
        criticalStock:
          type: integer
          description: Stock cr√≠tico para alertas
          minimum: 0
          maximum: 999999
          example: 5
        isActive:
          type: boolean
          description: ¬øEl instrumento est√° activo en inventario?
          default: true
          example: true
        created_at:
          type: string
          format: date-time
          description: Fecha de creaci√≥n
          example: "2024-01-15T10:30:00.000Z"
        updated_at:
          type: string
          format: date-time
          description: Fecha de √∫ltima actualizaci√≥n
          example: "2024-01-15T10:30:00.000Z"
      required:
        - id
        - name
        - description
        - price
        - quantity
        - categoryId
        - location
        - criticalStock
        - isActive

    CreateProductRequest:
      type: object
      required:
        - name
        - description
        - price
        - quantity
        - categoryId
        - location
        - criticalStock
        - isActive
      properties:
        name:
          type: string
          description: Nombre del instrumento industrial minero
          maxLength: 100
          example: "Sensor de Presi√≥n Industrial"
        description:
          type: string
          description: Descripci√≥n detallada del instrumento
          maxLength: 500
          example: "Sensor de presi√≥n diferencial para monitoreo de fluidos en miner√≠a subterr√°nea"
        price:
          type: number
          format: float
          description: Precio unitario del instrumento
          minimum: 0
          maximum: 999999.99
          example: 1250.00
        quantity:
          type: integer
          description: Cantidad inicial en inventario
          minimum: 0
          maximum: 999999
          example: 15
        categoryId:
          type: integer
          description: ID de la categor√≠a del instrumento
          minimum: 1
          example: 2
        location:
          type: string
          description: Ubicaci√≥n f√≠sica o almac√©n del instrumento
          maxLength: 200
          example: "Bodega Central - Zona Norte"
        criticalStock:
          type: integer
          description: Stock cr√≠tico para alertas
          minimum: 0
          maximum: 999999
          example: 5
        isActive:
          type: boolean
          description: ¬øEl instrumento est√° activo en inventario?
          default: true
          example: true

    UpdateProductRequest:
      type: object
      properties:
        name:
          type: string
          description: Nuevo nombre del instrumento
          maxLength: 100
          example: "Transmisor de Temperatura RTD"
        description:
          type: string
          description: Nueva descripci√≥n del instrumento
          maxLength: 500
          example: "Transmisor de temperatura con sensor RTD Pt100 para control de procesos mineros"
        price:
          type: number
          format: float
          description: Nuevo precio unitario
          minimum: 0
          maximum: 999999.99
          example: 890.00
        quantity:
          type: integer
          description: Nueva cantidad en inventario
          minimum: 0
          maximum: 999999
          example: 25
        categoryId:
          type: integer
          description: Nuevo ID de la categor√≠a
          minimum: 1
          example: 3
        location:
          type: string
          description: Nueva ubicaci√≥n f√≠sica
          maxLength: 200
          example: "Bodega Sur - Zona Mina"
        criticalStock:
          type: integer
          description: Nuevo stock cr√≠tico
          minimum: 0
          maximum: 999999
          example: 3
        isActive:
          type: boolean
          description: ¬øEl instrumento est√° activo?
          example: false

    # Esquemas de Respuesta
    ProductResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Producto obtenido exitosamente"
        data:
          $ref: '#/components/schemas/Product'
        timestamp:
          type: string
          format: date-time
          example: "2024-01-15T10:30:00.000Z"

    ProductListResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Productos obtenidos exitosamente"
        data:
          type: object
          properties:
            products:
              type: array
              items:
                $ref: '#/components/schemas/Product'
            pagination:
              $ref: '#/components/schemas/Pagination'
        timestamp:
          type: string
          format: date-time
          example: "2024-01-15T10:30:00.000Z"

    Pagination:
      type: object
      properties:
        page:
          type: integer
          description: P√°gina actual
          example: 1
        limit:
          type: integer
          description: Elementos por p√°gina
          example: 20
        total:
          type: integer
          description: Total de elementos
          example: 100
        totalPages:
          type: integer
          description: Total de p√°ginas
          example: 5
        hasNext:
          type: boolean
          description: ¬øHay p√°gina siguiente?
          example: true
        hasPrev:
          type: boolean
          description: ¬øHay p√°gina anterior?
          example: false

    DeleteResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Producto eliminado exitosamente"
        data:
          type: object
          properties:
            id:
              type: integer
              description: ID del producto eliminado
              example: 1
            deleted_at:
              type: string
              format: date-time
              description: Fecha de eliminaci√≥n
              example: "2024-01-15T12:00:00.000Z"
        timestamp:
          type: string
          format: date-time
          example: "2024-01-15T12:00:00.000Z"

    # Esquemas de Error
    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
          description: Mensaje de error descriptivo
          example: "Producto no encontrado"
        error:
          type: string
          description: C√≥digo de error
          enum: [VALIDATION_ERROR, NOT_FOUND, UNAUTHORIZED, FORBIDDEN, INTERNAL_ERROR, INVALID_CREDENTIALS]
          example: "NOT_FOUND"
        timestamp:
          type: string
          format: date-time
          example: "2024-01-15T10:30:00.000Z"

    ValidationErrorResponse:
      allOf:
        - $ref: '#/components/schemas/ErrorResponse'
        - type: object
          properties:
            details:
              type: array
              description: Detalles de los errores de validaci√≥n
              items:
                type: object
                properties:
                  field:
                    type: string
                    description: Campo con error
                    example: "name"
                  message:
                    type: string
                    description: Mensaje de error espec√≠fico
                    example: "El nombre es requerido"
                  value:
                    type: string
                    description: Valor proporcionado (opcional)
                    example: ""
              example:
                - field: "name"
                  message: "El nombre es requerido"
                  value: ""
                - field: "price"
                  message: "El precio debe ser mayor a 0"
                  value: -1
