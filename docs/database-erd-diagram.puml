@startuml
skinparam classAttributeIconSize 0

class Usuarios #ADD8E6 {
  +id: serial [PK]
  +email: varchar(100) [UK]
  +password: varchar(255)
  +name: varchar(100)
  +role: varchar(20)
  +is_active: boolean
  +created_at: timestamp
  +updated_at: timestamp
}

class Categorias #90EE90 {
  +id: serial [PK]
  +name: varchar(100) [UK]
  +description: text
  +parent_id: int [FK]
  +is_active: boolean
  +created_at: timestamp
  +updated_at: timestamp
}

class Ubicaciones #FFD580 {
  +id: serial [PK]
  +name: varchar(100)
  +description: text
  +zone: varchar(50)
  +shelf: varchar(50)
  +is_active: boolean
  +created_at: timestamp
  +updated_at: timestamp
}

class Proveedores #DDA0DD {
  +id: serial [PK]
  +name: varchar(200)
  +contact_person: varchar(100)
  +email: varchar(100)
  +phone: varchar(20)
  +address: text
  +is_active: boolean
  +created_at: timestamp
  +updated_at: timestamp
}

class Productos #FFB6B6 {
  +id: serial [PK]
  +name: varchar(255)
  +description: text
  +sku: varchar(50) [UK]
  +price: numeric(10,2)
  +quantity: int
  +critical_stock: int
  +category_id: int [FK]
  +location_id: int [FK]
  +supplier_id: int [FK]
  +is_active: boolean
  +created_at: timestamp
  +updated_at: timestamp
}

class Movimientos #FFFACD {
  +id: serial [PK]
  +product_id: int [FK]
  +movement_type: varchar(20)
  +quantity: int
  +previous_quantity: int
  +new_quantity: int
  +reason: varchar(200)
  +user_id: int [FK]
  +created_at: timestamp
}

class Auditoria #D3D3D3 {
  +id: serial [PK]
  +table_name: varchar(50)
  +record_id: int
  +action: varchar(20)
  +old_values: jsonb
  +new_values: jsonb
  +user_id: int [FK]
  +ip_address: inet
  +user_agent: text
  +created_at: timestamp
}

' Relaciones con texto didáctico
Productos --> Movimientos : "uno a muchos\n(Un producto tiene muchos movimientos)"
Movimientos --> Usuarios : "muchos a uno\n(Muchos movimientos los realiza un usuario)"
Productos --> Categorias : "muchos a uno\n(Muchos productos pertenecen a una categoría)"
Productos --> Ubicaciones : "muchos a uno\n(Muchos productos están en una ubicación)"
Productos --> Proveedores : "muchos a uno\n(Muchos productos tienen un proveedor)"
Auditoria --> Usuarios : "muchos a uno\n(Muchos logs los genera un usuario)"
Auditoria --> Productos : "muchos a uno\n(Muchos logs auditan un producto)"
Categorias --> Categorias : "muchos a uno\n(Muchas categorías pueden tener una categoría padre)"
@enduml 